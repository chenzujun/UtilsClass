<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="viewport"
	content="initial-scale=1.0, width=device-width,minimum-scale=1.0,maximum-scale=1.0, user-scalable=no" />
<title>Wish List猜颜色小游戏</title>
<link rel="stylesheet" type="text/css" href="gameTest.css">
<script src="http://code.jquery.com/jquery-2.0.0.min.js"
	type="text/javascript"></script>

<script>
	$(function() {
		eventHandler();
		function eventHandler() {
			var label = $('.label');
			label.on('click',
					function(e) {
						var $this = $(this);
						console.log($this);
						if ($this.hasClass('checked')) {
							return;
						} else {
							$this.addClass('checked').siblings().removeClass(
									'checked');
						}
					});
		}
	});
</script>
</head>

<body>
	<header class="headerDiv">
		<label>您目前有&nbsp;</label><label id="goldCount">5</label><label>&nbsp;个金币</label>
	</header>
	<section class="SectionDiv">
		<div class="bodyHeader">
			<p class="levelNum" align="center">第一关</h1>
			<p align="quesNum">第一题</h3>
		</div>
		<div>
			<div class="girlImgDiv" id="girlImgDiv">
				 <img src="1.png" id="girlImg" class="girlImg" />
				 <canvas id="myCanvas" class="mycanvas" ></canvas> 
				<img class="answerClass" id="answerCanvas" src="gright.png" />
				<div class="coinDiv" id="coinDiv" style="background-color: white">
					<div>
						<img class="coinClass" id="coinClass" src="coin.png" />
					</div>
					<div id="coinMes" class="coinMes">获得2个金币</div>
					<div>
						<a class="getCoinButton" id="getCoinButton" href=""></a>
					</div>
				</div>
				<script>
					var myCanvas = document.getElementById('myCanvas');
					var gray = myCanvas.getContext('2d');
					var girlImg = document.getElementById('girlImg');
					var girlImgDiv = document.getElementById('girlImg');
					var w = 144,
						h = 283;
						
						girlImgDiv.width = w;
					girlImgDiv.height = h;
					
					myCanvas.width = w;
					myCanvas.height = h;
					
					var msg1 = "亲！";
					var msg2 = "选择好了来刮我呀！";
					gray.beginPath();
					gray.fillStyle = "#e6dde5";
					gray.fillRect(2, 70, 140, 100);

					

					gray.closePath();
					gray.globalCompositeOperation = "destination-out";
					
//					var img = new Image();
					var img = document.getElementById('girlImg');
					var canvas = document.getElementById('myCanvas');
					canvas.style.backgroundColor='transparent';
					canvas.style.position = 'absolute';
					
					img.addEventListener('load', function(e) {
						var ctx;
					    var w = img.width,
					    	h = img.height*4/10;
					    var offsetX = canvas.offsetLeft,
					    	offsetY = canvas.offsetTop;
					    var mousedown = false;

					    function layer(ctx) {
					        ctx.fillStyle = 'gray';
					        ctx.fillRect(0, 0, w, h);
					        
					        ctx.font = "14px 黑体";
					        ctx.fillStyle = "#f42dab";
					        ctx.fillText(msg1, 10, 110);
					        ctx.fillText(msg2, 20, 140);
					    }

					    function eventDown(e){
					        e.preventDefault();
					        mousedown=true;
					    }

					    function eventUp(e){
					        e.preventDefault();
					        mousedown=false;
					    }

					    function eventMove(e){
					        e.preventDefault();
					        if(mousedown) {
					             if(e.changedTouches){
					                 e=e.changedTouches[e.changedTouches.length-1];
					             }
					             var x = (e.clientX + document.body.scrollLeft || e.pageX) - offsetX || 0,
					                 y = (e.clientY + document.body.scrollTop || e.pageY) - offsetY || 0;
					             with(ctx) {
					                 beginPath()
					                 arc(x, y, 10, 0, Math.PI * 2);
					                 fill();
					             }
					        }
					    }

					    canvas.width=w;
					    canvas.height=h;
					    canvas.style.backgroundImage='url('+img.src+')';
					    ctx=canvas.getContext('2d');
					    ctx.fillStyle='transparent';
					    ctx.fillRect(0, 0, w, h);
					    layer(ctx);

					    ctx.globalCompositeOperation = 'destination-out';

					    canvas.addEventListener('touchstart', eventDown);
					    canvas.addEventListener('touchend', eventUp);
					    canvas.addEventListener('touchmove', eventMove);
					    canvas.addEventListener('mousedown', eventDown);
					    canvas.addEventListener('mouseup', eventUp);
					    canvas.addEventListener('mousemove', eventMove);
					});
				</script>
			</div>
		</div>
		<div class="wrapper">
			<label class="label"> <span class="mockradio"></span> <input
				class="radiobox" name="color" type="radio" value="0" /> <span
				class="txt">白色</span>
			</label> <label class="label"> <span class="mockradio"></span> <input
				class="radiobox" name="color" type="radio" value="1" /> <span
				class="txt">红色</span>
			</label> <label class="label"> <span class="mockradio"></span> <input
				class="radiobox" name="color" type="radio" value="2" /> <span
				class="txt">黄色</span>
			</label> <label class="label"> <span class="mockradio"></span> <input
				class="radiobox" name="color" type="radio" value="3" /> <span
				class="txt">紫色</span>
			</label> <label class="label"> <span class="mockradio"></span> <input
				class="radiobox" name="color" type="radio" value="5" /> <span
				class="txt">黑色</span>
			</label>
		</div>
		<div class="sumbitDiv">
			<a  href="" >
				<img class="sumbitButton" src="sub.png">
			</a>
		</div>
	</section>
	<footer class="footerDiv">
		<a  href="" >
				<img class="duiHuanButton" alt="" src="cpresent.png">
		</a>
	</footer>
</body>
</html>